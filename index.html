<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Retro Diary</title>

  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="styles.css">
  <!-- Bas-tema; byts mellan light/dark via JS genom att uppdatera href -->
  <link id="themeLink" rel="stylesheet" href="theme_light.css">
  <!-- Minnesl√§ge-stilar (beh√∂ver alltid vara laddad) -->
  <link rel="stylesheet" href="theme_memory.css">
</head>
<body class="locked">
  <!-- Menyknapp -->
  <button id="menuToggle" class="btn">‚ò∞</button>

  <!-- Bok -->
  <div class="book">
    <!-- V√§nster (inneh√•ll) -->
    <section class="page" id="leftPage">
      <h2>Inneh√•ll</h2>
      <div class="searchRow">
        <input id="searchInput" type="search" placeholder="S√∂k titel/text‚Ä¶">
        <button id="searchBtn" class="btn">S√∂k</button>
        <button id="clearSearchBtn" class="btn">Rensa</button>
      </div>
      <ul id="entries"></ul>
    </section>

    <!-- H√∂ger (editor) -->
    <section class="page" id="rightPage">
      <div id="toolbar">
        <button id="boldBtn" class="btn"><b>B</b></button>
        <button id="italicBtn" class="btn"><i>I</i></button>
        <button id="underlineBtn" class="btn"><u>U</u></button>

        <select id="blockSelect" title="Block">
          <option value="p">Br√∂dtext</option>
          <option value="h1">Rubrik 1</option>
          <option value="h2">Rubrik 2</option>
          <option value="h3">Rubrik 3</option>
          <option value="blockquote">Citat</option>
        </select>

        <label class="color-swatch" title="Textf√§rg"><input id="foreColor" type="color"></label>
        <label class="color-swatch" title="Markering"><input id="hiliteColor" type="color" value="#fff9a8"></label>

        <button id="ulBtn" class="btn">‚Ä¢ Lista</button>
        <button id="olBtn" class="btn">1. Lista</button>
        <button id="leftBtn" class="btn">‚ü∏</button>
        <button id="centerBtn" class="btn">‚áî</button>
        <button id="rightBtn" class="btn">‚üπ</button>

        <button id="linkBtn" class="btn">L√§nk</button>
        <button id="unlinkBtn" class="btn">Bryt</button>

        <select id="fontFamily" title="Font" style="min-width:180px"></select>
        <select id="fontSize" title="Storlek">
          <option value="14px">14</option>
          <option value="16px" selected>16</option>
          <option value="18px">18</option>
          <option value="20px">20</option>
          <option value="22px">22</option>
          <option value="24px">24</option>
          <option value="28px">28</option>
        </select>

        <button id="btnImage" class="btn">üñºÔ∏è Bild</button>
        <button id="btnImgSmaller" class="btn">‚ûñ</button>
        <button id="btnImgBigger" class="btn">‚ûï</button>
        <button id="btnAudio" class="btn">üéµ Ljud</button>
      </div>

      <input id="titleInput" class="titleInput" placeholder="Titel‚Ä¶">
      <div id="dateLine"></div>
      <div id="editor" contenteditable="true" spellcheck="true"></div>

      <div id="actions">
        <button id="newBtn" class="btn">Ny sida</button>
        <button id="saveBtn" class="btn">Spara</button>
        <button id="deleteBtn" class="btn danger">Radera</button>
        <button id="lockBtn" class="btn">L√•s</button>
      </div>
    </section>
  </div>

  <!-- Sidomeny -->
  <aside id="menu" aria-hidden="true">
    <h2>Meny</h2>
    <button id="exportBtn" class="btn">Exportera (.json)</button>
    <input id="importInput" type="file" accept="application/json" hidden>
    <button id="importBtn" class="btn">Importera (.json)</button>

    <label for="themeSelect">Tema</label>
    <select id="themeSelect">
      <option value="light">Ljust</option>
      <option value="dark">M√∂rkt</option>
    </select>

    <!-- Minnesl√§ge-knapp -->
    <button id="memoryBtn" class="btn" aria-pressed="false">Minnesl√§ge</button>

    <button id="wipeBtn" class="btn danger">Rensa ALL lokal data</button>
  </aside>

  <!-- L√•ssk√§rm -->
  <div id="lockscreen" class="lock">
    <div class="card">
      <h2>üîí Retro Diary</h2>
      <input type="password" id="passInput" placeholder="Dagbokens l√∂senord">
      <div class="row">
        <button id="setPassBtn" class="btn">S√§tt nytt l√∂sen</button>
        <button id="unlockBtn"  class="btn">L√•s upp</button>
      </div>
      <button id="wipeLocalOnLock" class="btn danger">Rensa ALL lokal data</button>
      <p id="status"></p>
    </div>
  </div>

  <!-- Dolda filinputs -->
  <input id="imgFile"   type="file" accept="image/*" hidden>
  <input id="audioFile" type="file" accept="audio/*" hidden>

  <!-- Force-update -->
  <button id="forceUpdateBtn" title="Rensa cache och ladda om">‚ü≥ Uppdatera app</button>

  <!-- JS (defer s√• allt alltid hinner renderas) -->
  <script src="fonts_db.js" defer></script>
  <script src="crypto.js" defer></script>
  <script src="storage.js" defer></script>
  <script src="lock.js" defer></script>
  <script src="editor.js" defer></script>
  <script src="memory.js" defer></script>
  <script src="app.js" defer></script>

  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js').catch(()=>{});
    }
  </script>
</body>
  </html>
