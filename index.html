<!doctype html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Retro Diary</title>

  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#2b1f1a">
  <link rel="icon" href="icon-192.png" sizes="192x192">
  <link rel="apple-touch-icon" href="icon-192.png">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="frame">
    <div class="titlebar">
      <div class="brand">
        <div class="badge"></div>
        <div>Retro Diary</div>
      </div>
      <div class="actions">
        <button id="newEntryBtn">Ny sida</button>

        <div class="menu">
          <button id="menuBtn" class="ghost">‚ãÆ</button>
          <div id="menuDrop" class="dropdown" hidden>
            <button id="exportBtn">Exportera (krypterad .json)</button>
            <label class="filebtn">
              Importera (krypterad .json)
              <input id="importFile" type="file" accept="application/json" hidden>
            </label>
            <hr>
            <button id="enableBioBtn">Aktivera biometrisk uppl√•sning</button>
            <button id="disableBioBtn">St√§ng av biometrisk uppl√•sning</button>
            <hr>
            <button id="showRecoveryBtn">Visa/Skapa √•terst√§llningskod</button>
            <button id="resetPasswordBtn">Byt/√Öterst√§ll l√∂senord</button>
          </div>
        </div>

        <button id="lockBtn" class="ghost">L√•s</button>
      </div>
    </div>

    <div class="wrap">
      <aside class="sidebar">
        <div class="entry-list" id="list"></div>
      </aside>
      <main class="content">
        <div class="date-line" id="dateLine"></div>
        <textarea id="editor" placeholder="Skriv fritt. Allt krypteras p√• enheten."></textarea>
        <div class="toolbar">
          <button id="saveBtn">Spara</button>
          <button id="deleteBtn" class="danger">Radera</button>
        </div>
        <div class="stamp" id="stamp"></div>
      </main>
    </div>

    <!-- L√•ssk√§rm -->
    <div class="lockscreen" id="lockscreen" hidden>
      <div class="lockcard">
        <h2>üîí L√•s upp dagboken</h2>
        <p class="hint">F√∂rsta g√•ngen du anger ett l√∂senord skapas din nyckel. Gl√∂mmer du det √§r inneh√•llet o√•tkomligt utan din √•terst√§llningskod.</p>
        <div class="field">
          <input id="pass" type="password" autocomplete="current-password" placeholder="L√∂senord">
        </div>
        <div class="field">
          <button id="unlockBtn">L√•s upp</button>
          <button id="bioUnlockBtn" class="ghost">Biometrisk uppl√•sning</button>
        </div>
        <div class="status" id="status"></div>
        <div class="tiny"><button id="useRecoveryBtn" class="linklike">Har √•terst√§llningskod?</button></div>
      </div>
    </div>

    <!-- √Öterst√§llningsmodal -->
    <dialog id="recoveryDialog">
      <h3>√Öterst√§llningskod</h3>
      <p class="hint">Spara koden s√§kert (offline). Med den kan du byta l√∂senord om du gl√∂mmer det.</p>
      <div class="field">
        <input id="recoveryCode" type="text" readonly>
        <button id="copyRecovery" class="ghost">Kopiera</button>
      </div>
      <div class="field">
        <button id="regenRecovery">Generera ny</button>
        <button id="closeRecovery" class="ghost">St√§ng</button>
      </div>
      <p class="tiny">Obs! Ny √•terst√§llningskod ers√§tter den gamla.</p>
    </dialog>

    <!-- Byt/√•terst√§ll l√∂senord -->
    <dialog id="resetDialog">
      <h3>Byt/√Öterst√§ll l√∂senord</h3>
      <p class="hint">Ange din √•terst√§llningskod f√∂r att l√•sa upp nyckeln och s√§tt nytt l√∂senord.</p>
      <div class="field"><input id="rcInput" type="text" placeholder="√Öterst√§llningskod (t.ex. XXXX-XXXX-XXXX-XXXX)"></div>
      <div class="field"><input id="newPass1" type="password" placeholder="Nytt l√∂senord"></div>
      <div class="field"><input id="newPass2" type="password" placeholder="Upprepa nytt l√∂senord"></div>
      <div class="field">
        <button id="applyReset">Spara nytt l√∂senord</button>
        <button id="cancelReset" class="ghost">Avbryt</button>
      </div>
      <div class="status" id="resetStatus"></div>
    </dialog>
  </div>

  <script src="app.js" defer></script>
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => navigator.serviceWorker.register('./sw.js'));
    }
  </script>
</body>
              </html>
